<!DOCTYPE html>
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Muli&effect=fire-animation" rel="stylesheet">
<link href="styles.css" type="text/css" rel="stylesheet">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js">//inspired by https://coderbyte.com/tutorial/create-a-tic-tac-toe-game-using-html-css-and-jquery</script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!--modal code-->

<script>
$(document).ready(function(){
    $(function() {
        $("#custom-modal").modal('show');
    });

    $("#confirm").on("click", function(){
        $("#custom-modal").modal('hide');
        var $team = $('#selectTeam option:selected').attr("id");
        var $gM = $('#selectGM option:selected').attr("id");
        gameRules($team, $gM);
    });
    /*$('#restart').on('click', function ($team, $gM){
        $('#win-modal').modal('hide');
        $('#1').html("");
        $('#2').html("");
        $('#3').html("");
        $('#4').html("");
        $('#5').html("");
        $('#6').html("");
        $('#7').html("");
        $('#8').html("");
        $('#9').html("");
        gameRules($team, $gM);
    });*/
    //Function for checking winners and updating cells
    function winnerCheck(){
        var $t1 = $('#1').html();
        var $t2 = $('#2').html();
        var $t3 = $('#3').html();
        var $t4 = $('#4').html();
        var $t5 = $('#5').html();
        var $t6 = $('#6').html();
        var $t7 = $('#7').html();
        var $t8 = $('#8').html();
        var $t9 = $('#9').html();
        //Sees if anyone has won with X's
        if ($t1 == $t2 && $t2 == $t3){//($t1 == $t2 == $t3 && $t1, $t2, $t3 !== "")
            return $t1;
        } else if ($t4 == $t5 && $t5 == $t6){
            return $t4;
        } else if ($t7 == $t8 && $t8 == $t9){
            return $t7;
        } else if ($t1 == $t4 && $t4 == $t7){//Good
            return $t1;
        } else if ($t2 == $t5 && $t5 == $t8){//Good
            return $t2;
        } else if ($t3 == $t6 && $t6 == $t9){//Not good
            return $t3;
        } else if ($t1 == $t5 && $t5 == $t9){
            return $t1;
        } else if ($t3 == $t5 && $t5 == $t7){
            return $t3;
        } else {
            return -1;
        }
    }
    function winnerCheckLogicX(){
        if (winnerCheck() != -1 && winnerCheck() != ""){
            if (winnerCheck() == 'x'){
                //alert Player one wins!
                    $('#winEdit').html(<center>'X won!'</center>);
                    $("#win-modal").modal('show');

              } else{
                      $('winEdit').html(<center>'O won!'</center>);
                      $("#win-modal").modal('show');
                      table.off();

            }
        }
    }
    function winnerCheckLogicO(){
        if (winnerCheck() != -1 && winnerCheck() != ""){
            if (winnerCheck() == "o"){
                    $('#winEdit').html('O won!');
                    $("#win-modal").modal('show');
            } else{
                    $('#winEdit').html('X won!');
                    $("#win-modal").modal('show');
            }
        }
    }
    //Four combinations for game settings- SP/X, SP/O, TP/X, TP/O
    function gameRules($team, $gM){
        if ($gM == 'sP'){
            console.log('sP');
            if ($team == 'x'){
                console.log('x');
                var $player2 = 'o';
            } else{
                console.log('o');
                var $player2 = 'x';
            }





            //TWO PLAYER
        } else{
            console.log('tP');
            if ($team == 'x'){
                console.log('x');
                var $player2 = 'o';
                //Game logic variables declared,
                var table = document.querySelector('table');
                var turn = 0;
                var checkedSpots = [0];
                //Everything after occurs when you click on a cell in the table
                table.addEventListener('click', function (ev) {
                    var serviceID = ev.target.id;
                    //winnerCheckLogicX();
                    if (checkedSpots.length >= 9){
                        $(function() {
                            $("#draw-modal").modal('show');
                        });
                     }
                    //should be checking for a draw
                    //Marks selected spot, checks if already used
                    if (checkedSpots.includes(parseInt(serviceID))){
                        console.log('Already Picked!');
                        alert('Already picked!');
                        console.log(checkedSpots);
                        return;
                    } else if(turn % 2 == 0){
                        $('#'+serviceID).html($team);
                        turn++;
                        checkedSpots.push(parseInt(serviceID));
                        winnerCheckLogicX();
                        return turn;
                    } else {
                        $('#'+serviceID).html($player2);
                        turn++;
                        checkedSpots.push(parseInt(serviceID));
                        winnerCheckLogicX();
                        return turn;
                    }
                });
            } else{
                console.log('o');
                var $player2 = 'x';
                //Game logic variables declared,
                var table = document.querySelector('table');
                var turn = 0;
                var checkedSpots = [0];
                //Everything after occurs when you click on a cell in the table
                table.addEventListener('click', function (ev) {
                    var serviceID = ev.target.id;
                    console.log(checkedSpots);
                    //winnerCheckLogicO();
                    if (checkedSpots.length >= 9){
                        $(function() {
                            $("#draw-modal").modal('show');
                        });
                     }
                    //should be checking for a draw
                    //Marks selected spot, checks if already used
                    if (checkedSpots.includes(parseInt(serviceID))){
                        console.log('Already Picked!');
                        alert('Already picked!');
                        return;
                    } else if(turn % 2 == 0){
                        $('#'+serviceID).html("o");
                        turn++;
                        checkedSpots.push(parseInt(serviceID));
                        winnerCheckLogicO();
                        return turn;
                    } else {
                        $('#'+serviceID).html("x");
                        turn++;
                        checkedSpots.push(parseInt(serviceID));
                        winnerCheckLogicO();
                        return turn;
                    }
                });
            }
        }
    }
});
</script>
<head>
    <meta charset= "UTF-8">
    <title>TicTacToe</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<html>
<body>
    <h1 style="text-align: center" class="font-effect-fire-animation">TicTacToe</h1>

    <div class="container">
        <table id='board' style="background-color: white;">
            <tr>
                <td id="1"></td><td id="2"></td><td id="3"></td>
            </tr>
            <tr>
                <td id="4"></td><td id="5"></td><td id="6"></td>
            </tr>
            <tr>
                <td id="7"></td><td id="8"></td><td id="9"></td>
            </tr>
        </table>
</div>
<div id='custom-modal' class="modal fade" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header" style="background-color: #cc0000"> <!-- #d9d9d9 #cccccc -->
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Game Settings: Please choose your mode and symbol.</h4>
                </div>
                <div class="modal-body" style="background-color: #ff3333;">
                    <select class="selectGM" id="selectGM">
                        <!--<option value="Team">Select Mode</option>-->
                        <option value="Single Player" id="sP">Single Player</option>
                        <option value="Two Player" id="tP">Two Player</option>
                    </select>
                    <select class="selectPieces" id="selectTeam">
                        <!--<option value="Team">Select Team</option>-->
                        <option value="X" id="x">X</option>
                        <option value="O" id="o">O</option>
                    </select>
                </div>
                    <div class="modal-footer" style="background-color: #cc0000">
                        <button id="confirm" style="background-color: #ffffff" type="button" class="btn btn-default" data-dismiss="modal">Confirm</button> <!--#33cc33-->
                    </div>
                </div>
            </div>
        </div>
        <div id='win-modal' class="modal fade" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header" style="background-color: #cc0000"> <!-- #d9d9d9 #cccccc -->
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 id="winEdit" class="modal-title"></h4>
                        </div>
                            <div class="modal-footer" style="background-color: #cc0000">
                                <button id="changeGM" style="background-color: #ffffff" type="button" class="btn btn-default" onClick="window.location.reload()">Play Again</button> <!--#33cc33-->
                            </div>
                        </div>
                    </div>
                </div>
                <div id='draw-modal' class="modal fade" role="dialog">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header" style="background-color: #cc0000"> <!-- #d9d9d9 #cccccc -->
                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                                    <h4 class="modal-title">Draw!</h4>
                                </div>
                                    <div class="modal-footer" style="background-color: #cc0000">
                                        <button id="changeGM" style="background-color: #ffffff" type="button" class="btn btn-default"  onClick="window.location.reload()">Play Again</button> <!--#33cc33-->
                                    </div>
                                </div>
                            </div>
                        </div>


<h3 style="font-size: 15px; color: white; font-faily: Muli; display: inline-block; position: fixed; right: 5px; bottom: 5px;">Made By: Elijah Harbut</h3>
</body>
</html>
